[% META title = 'EZ::360 - Create Page' -%]

<script type='text/javascript'>
    function add() {
        list  = document.getElementById('page-list-articles');
        added = document.getElementById('page-added-articles')
        if ( list.selectedIndex != -1 ) {
            var option = document.createElement('option'); 
            option.text  = list.options[ list.selectedIndex ].text;
            option.value = list.options[ list.selectedIndex ].value;
            document.getElementById('page-added-articles').add( option, null );
            list.remove(list.selectedIndex);
        }
    }

    function remove() {
        added = document.getElementById('page-added-articles');
        if ( added.selectedIndex != -1 ) {
            var option = document.createElement('option'); 
            option.text  = added.options[ added.selectedIndex ].text;
            option.value = added.options[ added.selectedIndex ].value;
            document.getElementById('page-list-articles').add( option, null );
            added.remove(added.selectedIndex);
        }
    }

    function make_article_list() {
        added = document.getElementById('page-added-articles');
        for ( i = 0; i < added.length; i++ ) {
            document.getElementById('articles').value += added.options[i].value + ' ';
        }
    }
</script>

<form method='post' action='[% c.uri_for("/page/create") %]' onsubmit='make_article_list()'>
    <fieldset class='page-create'>
        <legend>Create Page</legend>
        <div class='field page-title'>
            <label for='page-title'>Title:</label>
            <input type='text' name='title' id='page-title' />
        </div>
        <div class='field page-articles'>
            <select class='page-list-articles' id='page-list-articles' size='10'>
                [% FOREACH article IN articles -%]
                <option value='[% article.id %]'>[% article.title %]</option>
                [% END -%]
            </select>
            <a class='add' href='javascript:void(0)' onclick='add()' >Add</a>
            <a class='remove' href='javascript:void(0)' onclick='remove()'>Remove</a>
            <select class='page-added-articles' id='page-added-articles' size='10'>
            </select>
            <input type='text' name='articles' id='articles' style='display: none' />
        </div>
        <div class='button page-create'>
            <input type='submit' value='Create Page' />
        </div>
    </fieldset>
</form>
